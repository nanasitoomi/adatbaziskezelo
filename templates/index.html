{% extends 'base.html' %}

{% block title %}Heinemann Termékadatbázis - Kezdőlap{% endblock %}

{% block content %}
<div class="row mt-4">
    <div class="col-md-12">
        <div class="alert alert-info">
            <h4 class="alert-heading"><i class="bi bi-info-circle-fill me-2"></i>Termékadatbázis információ</h4>
            <p>Ez a felület a Heinemann termékadatbázis kezelésére és összehasonlítására szolgál. Az adatbázis két fő forrásból építkezik:</p>

            <div class="row mt-3">
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-header bg-dark text-white">
                            <h5 class="mb-0"><i class="bi bi-shop me-2"></i>Shopify termékek</h5>
                        </div>
                        <div class="card-body">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item"><i class="bi bi-check-circle-fill text-success me-2"></i>Webshop termékek adatai</li>
                                <li class="list-group-item"><i class="bi bi-check-circle-fill text-success me-2"></i>Termékleírások és metaadatok</li>
                                <li class="list-group-item"><i class="bi bi-check-circle-fill text-success me-2"></i>Kategóriák és szűrési lehetőségek</li>
                                <li class="list-group-item"><i class="bi bi-check-circle-fill text-success me-2"></i>Képek és médiaanyagok</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-header bg-dark text-white">
                            <h5 class="mb-0"><i class="bi bi-database me-2"></i>Business Central adatok</h5>
                        </div>
                        <div class="card-body">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item"><i class="bi bi-check-circle-fill text-success me-2"></i>Vállalati rendszerből exportált cikkek</li>
                                <li class="list-group-item"><i class="bi bi-check-circle-fill text-success me-2"></i>Belső kategóriák és csoportosítások</li>
                                <li class="list-group-item"><i class="bi bi-check-circle-fill text-success me-2"></i>Termék azonosítók és cikkszámok</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-3">
                <h5><i class="bi bi-tools me-2"></i>Fő funkciók:</h5>
                <ul class="list-unstyled">
                    <li><i class="bi bi-search me-2"></i><strong>Keresés és szűrés:</strong> Termékek gyors megtalálása különböző kritériumok alapján</li>
                    <li><i class="bi bi-arrow-left-right me-2"></i><strong>Összehasonlítás:</strong> Shopify és Business Central adatok összevetése</li>
                    <li><i class="bi bi-filter-square me-2"></i><strong>Kategória szűrés:</strong> Termékek megtekintése kategóriák szerint</li>
                    <li><i class="bi bi-globe me-2"></i><strong>Származási hely:</strong> Termékek szűrése ország/régió szerint</li>
                </ul>
            </div>
        </div>

        <!-- Gyorselérési boxok -->
        <div class="row mt-4">
            <div class="col-md-6 pe-1">
                <a href="/products" class="text-decoration-none">
                    <div class="card bg-dark text-white h-100">
                        <div class="card-body text-center py-5">
                            <i class="bi bi-shop display-1 mb-3"></i>
                            <h3 class="card-title">Web termékek</h3>
                        </div>
                    </div>
                </a>
            </div>
            <div class="col-md-6 ps-1">
                <a href="/compare" class="text-decoration-none">
                    <div class="card bg-dark text-white h-100">
                        <div class="card-body text-center py-5">
                            <i class="bi bi-arrow-left-right display-1 mb-3"></i>
                            <h3 class="card-title">BC - Shopify összehasonlítás</h3>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">Gyors keresés</h5>
            </div>
            <div class="card-body">
                <form action="/products" method="get" class="row g-3">
                    <div class="col-md-6">
                        <input type="text" name="search" class="form-control form-control-lg" placeholder="Terméknév, leírás vagy márka...">
                    </div>
                    <div class="col-md-4">
                        <select name="product_type" class="form-select form-select-lg">
                            <option value="">Minden terméktípus</option>
                            {% for type in product_types %}
                            <option value="{{ type.product_type }}">{{ type.product_type }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-primary btn-lg w-100">Keresés</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4" id="mainAccordion">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#categoriesCollapse" aria-expanded="true" aria-controls="categoriesCollapse" style="cursor: pointer;">
                <h5 class="card-title mb-0">
                    <i class="bi bi-chevron-down me-2"></i> Terméktípusok
                </h5>
            </div>
            <div class="collapse show" id="categoriesCollapse" data-bs-parent="#mainAccordion">
                <div class="card-body">
                    <div class="row">
                        {% for type in product_types %}
                        <div class="col-md-3 mb-2">
                            <a href="/products?product_type={{ type.product_type }}" class="btn btn-outline-primary w-100">{{ type.product_type }}</a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4" id="categoryAccordion">
    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#adminCategoriesCollapse" aria-expanded="true" aria-controls="adminCategoriesCollapse" style="cursor: pointer;">
                <h5 class="card-title mb-0">
                    <i class="bi bi-chevron-down me-2"></i> Termék kategóriák
                </h5>
            </div>
            <div class="collapse show" id="adminCategoriesCollapse" data-bs-parent="#categoryAccordion">
                <div class="card-body">
                    <div class="row">
                        {% for category in categories %}
                        <div class="col-md-6 mb-2">
                            <a href="/products?category={{ category.category_name }}" class="btn btn-outline-primary w-100">{{ category.category_name }}</a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#originsCollapse" aria-expanded="true" aria-controls="originsCollapse" style="cursor: pointer;">
                <h5 class="card-title mb-0">
                    <i class="bi bi-chevron-down me-2"></i> Származási helyek
                </h5>
            </div>
            <div class="collapse show" id="originsCollapse" data-bs-parent="#categoryAccordion">
                <div class="card-body">
                    <div class="row">
                        {% for origin in origins %}
                        <div class="col-md-4 mb-2">
                            <a href="/products?origin={{ origin.origin }}" class="btn btn-outline-primary w-100">{{ origin.origin }}</a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Ízjegyek és Érlelési módok -->
<div class="row mt-4" id="tasteAccordion">
    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#tasteNotesCollapse" aria-expanded="true" aria-controls="tasteNotesCollapse" style="cursor: pointer;">
                <h5 class="card-title mb-0">
                    <i class="bi bi-chevron-down me-2"></i> <i class="bi bi-cup-hot me-1"></i> Ízjegyek
                </h5>
            </div>
            <div class="collapse show" id="tasteNotesCollapse" data-bs-parent="#tasteAccordion">
                <div class="card-body">
                    <div class="row">
                        {% for taste in taste_notes %}
                        <div class="col-md-6 mb-2">
                            <a href="/products?taste={{ taste.taste_notes }}" class="btn btn-outline-primary w-100 text-truncate" title="{{ taste.taste_notes }}">{{ taste.taste_notes }}</a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#agingMethodsCollapse" aria-expanded="true" aria-controls="agingMethodsCollapse" style="cursor: pointer;">
                <h5 class="card-title mb-0">
                    <i class="bi bi-chevron-down me-2"></i> <i class="bi bi-hourglass-split me-1"></i> Érlelési módok
                </h5>
            </div>
            <div class="collapse show" id="agingMethodsCollapse" data-bs-parent="#tasteAccordion">
                <div class="card-body">
                    <div class="row">
                        {% for method in aging_methods %}
                        <div class="col-md-6 mb-2">
                            <a href="/products?aging_method={{ method.aging_method }}" class="btn btn-outline-primary w-100 text-truncate" title="{{ method.aging_method }}">{{ method.aging_method }}</a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Szőlőfajták -->
<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header" data-bs-toggle="collapse" data-bs-target="#grapeVarietiesCollapse" aria-expanded="true" aria-controls="grapeVarietiesCollapse" style="cursor: pointer;">
                <h5 class="card-title mb-0">
                    <i class="bi bi-chevron-down me-2"></i> <i class="bi bi-flower1 me-1"></i> Szőlőfajták
                </h5>
            </div>
            <div class="collapse show" id="grapeVarietiesCollapse">
                <div class="card-body">
                    <div class="row">
                        {% for grape in grape_varieties %}
                        <div class="col-md-3 mb-2">
                            <a href="/products?grape_variety={{ grape.grape_variety }}" class="btn btn-outline-primary w-100 text-truncate" title="{{ grape.grape_variety }}">{{ grape.grape_variety }}</a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Minden dropdown nyitva marad, nem zárjuk be automatikusan a többit
        // A dropdown ikonok forgatása
        const collapseElements = document.querySelectorAll('.collapse');
        collapseElements.forEach(collapse => {
            collapse.addEventListener('show.bs.collapse', function() {
                const header = this.previousElementSibling;
                const icon = header.querySelector('.bi-chevron-down');
                if (icon) {
                    icon.classList.remove('bi-chevron-down');
                    icon.classList.add('bi-chevron-up');
                }
            });

            collapse.addEventListener('hide.bs.collapse', function() {
                const header = this.previousElementSibling;
                const icon = header.querySelector('.bi-chevron-up');
                if (icon) {
                    icon.classList.remove('bi-chevron-up');
                    icon.classList.add('bi-chevron-down');
                }
            });

            // Inicializálás - ha nyitva van, akkor a nyitott ikon
            if (collapse.classList.contains('show')) {
                const header = collapse.previousElementSibling;
                const icon = header.querySelector('.bi-chevron-down');
                if (icon) {
                    icon.classList.remove('bi-chevron-down');
                    icon.classList.add('bi-chevron-up');
                }
            }
        });
    });
</script>
{% endblock %}
